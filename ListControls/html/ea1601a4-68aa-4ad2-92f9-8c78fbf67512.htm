<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Combo Box Controls Tutorial</title><meta name="Title" content="Combo Box Controls Tutorial" /><meta name="Help.Id" content="ea1601a4-68aa-4ad2-92f9-8c78fbf67512" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="ea1601a4-68aa-4ad2-92f9-8c78fbf67512" /><meta name="Description" content="This control is derived from the standard .NET ComboBox control. The only differences are the addition of the auto-completion feature that selects items as you type and the data source indexer properties." /><meta name="tocFile" content="../toc/IDD.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div id="DocumentationTitle" class="level-item">EWSoftware.ListControls Library Documentation</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a><a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a><a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a><a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div id="ContentContainer" class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="Resizer" class="is-hidden"></div><div id="TopicContent" class="column content is-7"><h1>Combo Box Controls Tutorial</h1><div><p>This topic describes the Combo Box controls and their features.</p><ul class="is-hidden-tablet"><li><a href="#AutoComp">AutoCompleteComboBox Usage</a></li><li><a href="#Features">Common Features</a></li><li><a href="#Differences">Combo Box Behavior Differences</a></li><li><a href="#MCCombo">MultiColumnComboBox Usage</a></li><li><a href="#UCCombo">UserControlComboBox Usage</a></li><li><a href="#DDCtrl">Creating a Dropdown Control</a></li></ul></div><h2 id="AutoComp" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>AutoCompleteComboBox Usage</h2><div id="IDBABSection"><p>This control is derived from the standard .NET <span class="code">ComboBox</span> control. The only
differences are the addition of the auto-completion feature that selects items as you type and the data source
indexer properties.  Use this control when you want auto-completion but do not need the extra functionality of
the other combo box classes such as multi-column drop-down support.  To use it, simply drag the control from the
toolbox, drop it on the form, and use the <strong>Properties</strong> window to adjust its settings.</p></div><h2 id="Features" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Common Features</h2><div id="IDCABSection"><p>The <span class="code">MultiColumnComboBox</span> and <span class="code">UserControlComboBox</span>
are quite similar with regard to creation and usage.  Simply drag the control from the toolbox, drop it on the
form, and use the <strong>Properties</strong> window to adjust its settings.  For simple lists, you can
enter text strings in the designer by selecting the <span class="code">Items</span> property and entering the
values one per line in the collection editor.  When items are added directly to the <span class="code">Items</span>
collection, the <span class="code">SortOrder</span> property can be used to sort the items in ascending or
descending order.  The default sort order is <span class="code">None</span>.</p><p>A simple <span class="code">ListItem</span> object is supplied that can be used with an array list
as the data source for the list controls.  It contains a <span class="code">Display</span> property for the
display text and a <span class="code">Value</span> property for the value of the item.  The demo application
contains examples of its use.  A simple example is shown below:</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">ArrayList alRelevance = new ArrayList();

// Add list items to the array list containing a value and a description
alRelevance.Add(new ListItem(1, "Remote"));
alRelevance.Add(new ListItem(10, "Low"));
alRelevance.Add(new ListItem(30, "Medium"));
alRelevance.Add(new ListItem(80, "High"));

// Tell the combo box the value and display members and set the array list as the data source
cboMinRel.ValueMember = "Value";
cboMinRel.DisplayMember = "Display";
cboMinRel.DataSource = alRelevance;</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">Dim alRelevance As New ArrayList()

' Add list items to the array list containing a value and a description
alRelevance.Add(New ListItem(1, "Remote"))
alRelevance.Add(New ListItem(10, "Low"))
alRelevance.Add(New ListItem(30, "Medium"))
alRelevance.Add(New ListItem(80, "High"))

' Tell the combo box the value and display members and set the array list as the data source
cboMinRel.ValueMember = "Value"
cboMinRel.DisplayMember = "Display"
cboMinRel.DataSource = alRelevance</code></pre></div></div><p>The controls also support the same complex data sources that any other standard .NET control can
use (i.e. data sets, data views, data tables, arrays, etc).  Assigning a more complex data source is done in a
manner similar to the example above.  You set the <span class="code">DisplayMember</span> and
<span class="code">ValueMember</span> properties to members of the data source and then set the
<span class="code">DataSource</span> property to the complex data source (i.e. a data set, data view, etc).  If
assigning these three properties in code, always assign the <span class="code">DataSource</span> property last to
improve performance.  This is true of all .NET controls as assigning a new display or value member forces the
control to reevaluate its data source.  By assigning the data source last, it will only have to evaluate the data
source once.</p><p>The properties in the <strong>Appearance</strong> category can be used to alter the visual
style of the control.  To modify the drop-down style, its width, the default number of items to show, and the
control-specific properties, see the options in the <span class="code">DropDown</span> category.  The
control-specific properties are described in more detail in the sections below.</p><p>Both controls have an <span class="code">EnforceDefaultSelection</span> property that allows you to
specify whether a default selection will be set if an attempt is made to set the selected index to -1.  In
<span class="code">DropDownList</span> mode, if this property is true (the default), a <span class="code">SelectedIndex</span>
of -1 (no selection) is not allowed.  Instead, the index specified by the <span class="code">DefaultSelection</span>
property is used instead.  For the <span class="code">DropDown</span> and <span class="code">Simple</span> modes,
this property is ignored as values can be entered that are not in the list of valid items.</p><p>Once the drop-down has been displayed, it will retain the size and settings in effect until the
form closes or properties are changed that force it to get recreated.  If you need to force the drop-down portion
to get reset, you can call the <span class="code">RefreshSubControls</span> method.  This destroys the current
instance of the drop-down and causes it to get recreated the next time the drop-down is displayed.</p><p>Unlike the standard .NET list controls, all of the controls in the
<span class="code">EWSoftware.ListControls</span> namespace allow you to index their data source to extract
values.  This allows you to obtain the value of a field in the current selection or a field in any row even if it
is not the selected item and regardless of whether or not the field is used as the display or value member.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// Get the vendor name from the current selection
string vendorName = (string)cboVendors["VendorName"];

// Get the item quantity from the sixth row
int itemQty = (int)cboItems[5, "ItemQty"];</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">' Get the vendor name from the current selection
Dim vendorName As String = CType(cboVendors("VendorName"), String)

' Get the item quantity from the sixth row
Dim itemQty As Integer = CType(cboItems(5, "ItemQty"), Integer)</code></pre></div></div><p>The <span class="code">MultiColumnComboBox</span> and <span class="code">UserControlComboBox</span>
contain a <span class="code">DrawImage</span> property.  If set to true, the controls will raise the
<span class="code">DrawItemImage</span> event so that you can draw an image to the left of the text value in the
textbox portion of the control.  The event receives a reference to the combo box and a
<span class="code">DrawItemEventArgs</span> object that defines the item and its state.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// Draw an image for the demo.  They aren't representative of the items, they're just
// something to show.
private void cboMultiCol_DrawItemImage(object sender, DrawItemEventArgs e)
{
    if(e.Index == -1)
        e.DrawBackground();
    else
        e.Graphics.DrawImage(ilImages.Images[e.Index % ilImages.Images.Count], e.Bounds);
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">' Draw an image for the demo.  They aren't representative of the items, they're just
' something to show.
Private Sub cboMultiCol_DrawItemImage(sender As Object, e As DrawItemEventArgs) _
  Handles cboMultiCol.DrawItemImage
    If e.Index = -1 Then
        e.DrawBackground()
    Else
        e.Graphics.DrawImage(ilImages.Images(e.Index Mod ilImages.Images.Count), e.Bounds)
    End If
End Sub</code></pre></div></div></div><h2 id="Differences" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Combo Box Behavior Differences</h2><div id="IDDABSection"><p>The <span class="code">MultiColumnComboBox</span> and <span class="code">UserControlComboBox</span>
have a few differences in behavior compared to the standard .NET combo box control.  These are mostly to fix bugs
present in the standard combo box control and to add extra features not present in it.  They are as follows:</p><ul><li><p>You can bind almost any data source to the multi-column and user control combo boxes with the
exception of non-value-type objects added directly to the <span class="code">Items</span> collection.  The
workaround is to add the objects to an <span class="code">ArrayList</span> and use that as the data source.
Simple value types such as integers and strings can be added directly to the <span class="code">Items</span>
collection and displayed correctly.  All other standard data source types such as data sets, data views, and data
tables will work as expected.</p></li><li><p>A new <span class="code">OnCloseUp</span> event is fired when the drop-down portion is closed.
Note that unlike the standard Windows combo box, the <span class="code">SelectedIndexChanged</span> event will
always fire before the <span class="code">OnCloseUp</span> event.</p></li><li><p><span class="code">SelectionChangeCommitted</span> is fired correctly when the drop-down portion
is closed and the item was changed.  A new <span class="code">SelectionChangeCanceled</span> event is raised if
the drop-down is closed without changing the selection. The correct event is always fired after the
<span class="code">OnCloseUp</span> event.</p></li><li><p>A new <span class="code">NotInList</span> event is fired just prior to the
<span class="code">Validating</span> event if the text in the control does not match anything in the item list.
This event gives you the opportunity to cancel the attempt to update the value or take some other action (i.e.
add the value as a valid item, force it to a valid selection, etc).</p></li><li><p>The <span class="code">Text</span> property of the combo box controls always returns whatever is
in the text portion of the combo box.  There is a bug in the standard combo box control that causes it to not
work correctly if bound to a data source.</p></li><li><p>Setting the <span class="code">Text</span> property of the combo box controls will correctly
synchronize the <span class="code">SelectedIndex</span> property with the new text.  If the text is not found, the
selected index is correctly set to -1.  A bug in the standard combo box prevents this from happening.</p></li><li><p>Setting the <span class="code">SelectedIndex</span> property to -1 in a data-bound combo box
will always clear the selected item and the text. A bug in the standard combo box control causes this to fail
occasionally.</p></li><li><p>In the standard combo box control, when the data source properties are modified, it will force
the <span class="code">SelectedIndex</span> property to the current position in the data source rather than
keeping the default -1 (no selection) value.  Many people consider this to be a bug but others consider it to be
valid behavior.</p><p>For the <span class="code">MultiColumnComboBox</span> and <span class="code">UserControlComboBox</span>
in <span class="code">DropDownList</span> mode, the <span class="code">EnforceDefaultSelection</span> property can
be used to alter the behavior to suit your own preferences.  For example, it may be considered valid to force a
selection in this mode so that it contains a valid selection from the start. The property defaults to true which
makes it work like the standard combo box control (the selection is always changed).  If set to false and the
current <span class="code">SelectedIndex</span> value is -1 when a data source property changes, the "no
selection" state (-1) is retained.  In <span class="code">DropDown</span> and <span class="code">Simple</span>
mode, the <span class="code">EnforceDefaultSelection</span> property is ignored and the "no selection" state will
be retained when the data source is changed.  This is because those two modes do allow entry of text that does
not appear in the list of values.</p></li></ul></div><h2 id="MCCombo" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>MultiColumnComboBox Usage</h2><div id="IDEABSection"><p>By default, the <span class="code">MultiColumnComboBox</span> will display all columns from its data
source with some default formatting.  You can use the properties in the <span class="code">DropDown</span>
category to customize the appearance of the drop-down and the columns that are displayed in it.  A simple way to
limit the columns displayed is to use the <span class="code">ColumnFilter</span> property to let it know which
columns should appear in the drop-down.  The columns will be auto-sized based on the longest value in each
column.  Note that even though a column filter is in place for the drop-down you can still access any field in
the data source using the item indexer as shown earlier.  You can set the filter at design-time by selecting the
property and entering the column names to display one per line using the collection editor.  You can also specify
the column filter at runtime using code similar to the following:</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// Limit the drop-down to the vendor name and contact name
cboVendor.ColumnFilter.AddRange(new string[] { "VendorName", "Contact" });</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">' Limit the drop-down to the vendor name and contact name
cboVendor.ColumnFilter.AddRange(New String() { "VendorName", "Contact" })</code></pre></div></div><p>For full control over the visual style of the drop-down along with which columns are displayed,
their order, and their individual styles, you can use the <span class="code">DropDownFormat</span> property.  The
basic properties in it allows you to specify the color and grid line settings and whether or not column and row
headers are visible. By selecting the <span class="code">GridColumnStyles</span> property of
<span class="code">DropDownFormat</span> you can also specify the columns to display in the drop-down along with
their formatting options such as alignment, column header text, width, etc.  When specifying column definitions
in this manner, there is no need to use the <span class="code">ColumnFilter</span> property.</p><p>When defining grid column styles, you can use the standard text box or boolean data grid columns
supplied with .NET or you can use custom third-party column types such as label columns, image columns, progress
bar columns, etc (all drop-down data is read-only).  At design-time, only the standard text box and boolean
columns are accessible.  To use third-party column types, you should add them to the
<span class="code">DropDownFormat.GridColumnStyles</span> collection using code.</p><p>When specifying column definitions using grid column styles, setting their <span class="code">Width</span>
property to -1 will cause the drop-down to size the column to the preferred width. Setting the width to zero will
cause the drop-down to size the column to the longest value in the data source for the column.  Setting the width
to any other positive value will size the column to the specified width.  As with the column filter, you can set
the grid column styles at runtime using code.  An example is shown below.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// These can be created and set at design-time too
DataGridTextBoxColumn dgtbItemName = new DataGridTextBoxColumn();
DataGridTextBoxColumn dgtbExpireDate = new DataGridTextBoxColumn();
DataGridBoolColumn dgbcInStock = new DataGridBoolColumn();

// Set the column properties
dgtbItemName.HeaderText = "Item Name";
dgtbItemName.MappingName = "ItemName";
dgtbItemName.Width = 0;     // Size to widest item

dgtbExpireDate.Format = "MM/dd/yyyy";
dgtbExpireDate.HeaderText = "Expiration Date";
dgtbExpireDate.MappingName = "ExpireDate";
dgtbExpireDate.Width = -1;  // Size to preferred width

dgbcInStock.Alignment = HorizontalAlignment.Center;
dgbcInStock.HeaderText = "In Stock";
dgbcInStock.MappingName = "InStockYN";
dgtbExpireDate.Width = 100; // Fixed width

// Add the column definitions to the combo box control
cboItems.DropDownFormat.GridColumnStyles.AddRange(new DataGridColumnStyle[] {
    dgtbItemName, dgtbExpireDate, dgbcInStock });</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">' These can be created and set at design-time too
Dim dgtbItemName As New DataGridTextBoxColumn()
Dim dgtbExpireDate As New DataGridTextBoxColumn()
Dim dgbcInStock As New DataGridBoolColumn()

' Set the column properties
dgtbItemName.HeaderText = "Item Name"
dgtbItemName.MappingName = "ItemName"
dgtbItemName.Width = 0      ' Size to widest item

dgtbExpireDate.Format = "MM/dd/yyyy";
dgtbExpireDate.HeaderText = "Expiration Date";
dgtbExpireDate.MappingName = "ExpireDate";
dgtbExpireDate.Width = -1   ' Size to preferred width

dgbcInStock.Alignment = HorizontalAlignment.Center;
dgbcInStock.HeaderText = "In Stock";
dgbcInStock.MappingName = "InStockYN";
dgtbExpireDate.Width = 100  ' Fixed width

' Add the column definitions to the combo box control
cboItems.DropDownFormat.GridColumnStyles.AddRange(new DataGridColumnStyle() {
    dgtbItemName, dgtbExpireDate, dgbcInStock })</code></pre></div></div></div><h2 id="UCCombo" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>UserControlComboBox Usage</h2><div id="IDFABSection"><p>The <span class="code">UserControlComboBox</span> is similar in nature to other combo box controls
but it displays a user control that you create as its drop-down.  This allows you to create drop-downs that use
non-standard lists such as tree views, list views, or just about any other combination of controls that you can
imagine.  The drop-down will gain the focus when displayed so you can also put checkboxes, text boxes, buttons,
and other controls in the drop-down as well.</p><p>For this combo box, the <span class="code">MaxDropDownItems</span> property has no effect on the
drop-down size.  However, it is used to control how many items are skipped when you press page up or page down in
the textbox portion of the control.</p><p>The drop-down control type cannot be set at design-time so it must be assigned using code.  This is
most often done in the form's constructor after the <span class="code">InitializeComponent</span> method has been
called.  To do so, simply assign the drop-down control type to the <span class="code">DropDownControl</span>
property.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// TreeViewDropDown is a user control derived from DropDownControl
ucCombo.DropDownControl = typeof(TreeViewDropDown);</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">' TreeViewDropDown is a user control derived from DropDownControl
ucCombo.DropDownControl = GetType(TreeViewDropDown)</code></pre></div></div><p>The <span class="code">UserControlComboBox</span> exposes two events that you can use to customize
the settings of the drop-down control before it is displayed.  For example, you might need to hide certain
controls in the drop-down based on a condition in the form containing the combo box.  The
<span class="code">DropDownControlCreated</span> event is fired after the drop-down has been created but before it
has been initialized.  The <span class="code">DropDownControlInitialized</span> event is fired after the drop-down
has been created and initialized but just prior to it being displayed.  The <span class="code">sender</span>
parameter will be a reference to the drop-down control.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// Hide the "exclude terminated" checkbox for this form
private void cboAssignTo_DropDownControlCreated(object sender, EventArgs e)
{
    EmployeeDropDown dd = (EmployeeDropDown)sender;

    // This is a custom property on the drop-down user control
    dd.ShowExcludeTerminated = false;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">' Hide the "exclude terminated" checkbox for this form
Private Sub cboAssignTo_DropDownControlCreated(sender As Object, e As EventArgs) _
    Handles cboAssignTo.DropDownControlCreated
    Dim dd As EmployeeDropDown = CType(sender, EmployeeDropDown)

    ' This is a custom property on the drop-down user control
    dd.ShowExcludeTerminated = False
End Sub</code></pre></div></div></div><h2 id="DDCtrl" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Creating a Dropdown Control</h2><div id="IDGABSection"><p>The drop-down controls used by the <span class="code">UserControlComboBox</span> are all derived
from the supplied <span class="code">DropDownControl</span> class.  To create a new drop-down control, follow
these steps:</p><ol><li><p>Right click on the project in the <strong>Solution Explorer</strong>, select
<strong>Add</strong>, <strong>Add User Control</strong>, enter a name for the new user control,
and click <strong>Open</strong> to add it to the project.</p></li><li><p>Open the new user control in the designer and view the code for it.</p></li><li><p>Change the base class of the user control to <span class="code">EWSoftware.ListControls.DropDownControl</span>.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">public class TreeViewDropDown : EWSoftware.ListControls.DropDownControl</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">Public Class TreeViewDropDown
  Inherits EWSoftware.ListControls.DropDownControl</code></pre></div></div></li><li><p>Add controls to the template and any required event handlers for them as you would for any
other user control.  You can also define public properties and methods if necessary to let forms containing combo
boxes utilizing the drop-down control make changes to it using the events described in the prior section.</p></li><li><p>More likely than not, you will need to override the <span class="code">InitializeDropdown</span>
method to populate the controls and obtain data from the combo box that owns the drop-down.  The drop-down's
<span class="code">ComboBox</span> property can be used to obtain a reference to the <span class="code">UserControlComboBox</span>
that owns it.  The demo application contains an example of this.</p></li><li><p>You can also override the <span class="code">ShowDropDown</span> method if necessary to make
adjustments to the drop-down just prior to it being displayed.  For example, you might want to synchronize the
item displayed in the drop-down with the current selected index in the combo box.  The demo application contains
an example of this.</p></li><li><p>Once the drop-down has been created, you can assign its type to the
<span class="code">DropDownControl</span> property of the <span class="code">UserControlComboBox</span> as shown in
the prior section.</p></li></ol><p>The user can close the drop-down by hitting Escape or clicking outside of the drop-down just like a
normal combo box.  To cancel the selection process and close the drop-down from within your user control, you can
set the combo box's <span class="code">DroppedDown</span> property to false.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">private void btnCancel_Click(object sender, EventArgs e)
{
    this.ComboBox.DroppedDown = false;
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">Private Sub btnCancel_Click(sender As Object, e As EventArgs) _
  Handles btnCancel.Click
    Me.ComboBox.DroppedDown = False
End Sub</code></pre></div></div><p>To commit a selection making it the selected item in the combo box and close the drop-down from
within your user control, you can use the <span class="code">CommitSelection</span> method.  This method has two
versions: one to commit the selection by index and another to commit the selection by value (the
<span class="code">ValueMember</span> value of an item).</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">private void btnSelect_Click(object sender, EventArgs e)
{
    // The tree view node tag contains the item value
    this.CommitSelection(tvItems.SelectedNode.Tag);
}</code></pre></div></div><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">VB.NET</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vbnet">Private Sub btnSelect_Click(sender As Object, e As EventArgs) _
  Handles btnSelect.Click
    ' The tree view node tag contains the item value
    Me.CommitSelection(tvItems.SelectedNode.Tag)
End Sub</code></pre></div></div><p>Note that it is also possible to set the <span class="code">SelectedIndex</span> property from
within the user control to modify the selection (i.e. to track the selected item as you move through the nodes in
a tree view control).  The demo application contains an example of this.</p></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Other Resources</h4><div><a href="ce5cb77a-44a9-4629-aec3-6a8435cd8e53.htm">Control Tutorials</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">AutoCompleteComboBox Usage</a></li><li><a class="quickLink">Common Features</a></li><li><a class="quickLink">Combo Box Behavior Differences</a></li><li><a class="quickLink">MultiColumnComboBox Usage</a></li><li><a class="quickLink">UserControlComboBox Usage</a></li><li><a class="quickLink">Creating a Dropdown Control</a></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div id="FooterContent" class="column"><p><a href="https://github.com/EWSoftware/ListControls" target="_blank" rel="noopener noreferrer">[v2023.4.9.0] Copyright © 2005-2023, Eric Woodruff, All Rights Reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:Eric%40EWoodruff.us?Subject=EWSoftware.ListControls%20Library%20Documentation">Eric@EWoodruff.us</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script> 
				</div><div id="AdContent" class="column"><script type="text/javascript">
    function _dmBootstrap(file) {
        var _dma = document.createElement('script');
        _dma.type = 'text/javascript';
        _dma.async = true;
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
<div data-type="ad" data-publisher="ewsoftware.github.io" data-format="728x90" data-zone="ListControls"></div>
 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script></body></html>