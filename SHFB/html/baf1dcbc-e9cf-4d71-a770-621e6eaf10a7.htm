<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Creating a Presentation Style Component</title><meta name="Help.Id" content="baf1dcbc-e9cf-4d71-a770-621e6eaf10a7" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="baf1dcbc-e9cf-4d71-a770-621e6eaf10a7" /><meta name="Description" content="Sandcastle comes with some standard presentation styles used to apply formatting and layout to each generated topic. Rather than make changes directly to the Sandcastle presentation styles, you can clone them to create modified versions for yourself." /><meta name="tocFile" content="../toc/5f67b052-49b8-4c35-a345-a9935cc72a30.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/EWSoftware/SHFB"><img alt="Sandcastle Help File Builder" style="height: 69px;" src="../icons/Sandcastle.jpg" /></a></div><div id="DocumentationTitle" class="level-item">Sandcastle Help File Builder Documentation</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a><a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a><a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a><a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><div id="HeaderPrelimContainer" class="level my-1 px-2"><div id="HeaderTextContainer" class="level-left"><div class="level-item"><span class="has-text-grey-light">SHFB Default 2022 Style - Coming Soon</span></div></div></div><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Creating a Presentation Style Component</h1><div><p>Sandcastle comes with some standard presentation styles used to apply formatting and layout to each
generated topic.  Rather than make changes directly to the Sandcastle presentation styles, you can clone them to
create modified versions for yourself.  In addition, you can create entirely new presentation styles.  The help
file builder supports custom presentation styles and will make them available via the <span class="code">Presentation
Style</span> property.  This topic will walk you through the creation of a presentation style project.</p><ul class="is-hidden-tablet"><li><a href="#CreateProject">Creating the Project</a></li><li><a href="#Template">The Presentation Style Template Class</a></li><li><a href="#Metadata">The Export Attribute Metadata</a><ul><li><a href="#MetadataId">Id</a></li><li><a href="#MetadataTitle">Title</a></li><li><a href="#MetadataVersion">Version</a></li><li><a href="#MetadataCopyright">Copyright</a></li><li><a href="#MetadataDescription">Description</a></li><li><a href="#MetadataIsDeprecated">IsDeprecated</a></li></ul></li><li><a href="#PresentationStyleClass">The Presentation Style Class</a><ul><li><a href="#Location">Location</a></li><li><a href="#Constructor">Constructor</a></li><li><a href="#BasePath">BasePath</a></li><li><a href="#SupportedFormats">SupportedFormats</a></li><li><a href="#NamespaceGrouping">SupportsNamespaceGrouping</a></li><li><a href="#CodeSnippetGrouping">SupportsCodeSnippetGrouping</a></li><li><a href="#ResourceItems">ResourceItemsPath</a></li><li><a href="#ToolResourceItems">ToolResourceItemsPath</a></li><li><a href="#DocumentModelApplicator">DocumentModelApplicator</a></li><li><a href="#ApiTableOfContentsGenerator">ApiTableOfContentsGenerator</a></li><li><a href="#BuildAssemblerConfiguration">BuildAssemblerConfiguration</a></li><li><a href="#ContentFiles">ContentFiles</a></li><li><a href="#TransformComponentArguments">TransformComponentArguments</a></li><li><a href="#PlugInDependencies">PlugInDependencies</a></li></ul></li></ul></div><h2 id="CreateProject" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Creating the Project</h2><div id="IDBABSection"><p>This section describes how to create and configure the presentation style project.  It will
describe the process for a C# project but the steps should be fairly similar for a VB.NET project with a few
differences in the configuration option titles.</p><h3 class="quickLinkHeader">Create the Presentation Style Project</h3><div><ol><li><p>In Visual Studio, select the <strong>New Project</strong> option.  In the <strong>New Project</strong>
dialog box, select the C# or VB.NET language, and then select the <strong>Documentation</strong> subcategory.  Select the
<strong>Sandcastle Presentation Style Component</strong> template, give it a name and click <strong>OK</strong> to create it.
Once it has been created, right click on the project and select <strong>Properties</strong>.</p></li><li><p>In the <strong>Application</strong> tab, set the assembly name and default namespace as you see
fit.</p></li><li><p>In the <strong>Package</strong> tab, set the NuGet package properties.</p></li><li><p>On the <strong>Debug</strong> tab, set the <strong>Start Action</strong> to "Start external program" and
enter the path to the <em>SandcastleBuilderGUI.exe</em> program.  If you installed the help file
builder in the default location, this will be <em>%ProgramFiles(x86)%\EWSoftware\Sandcastle Help File
Builder\</em>.  If not, substitute your path as appropriate.</p><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Tip</p></div><div class="message-body"><p>Using the standalone GUI as the host is easier than using Visual Studio as the package
locks the assemblies once the help file builder project has loaded them for use and you will not be able to
rebuild them.  Shutting down the standalone GUI frees the assemblies so that you can rebuild them and start a new
debugging session.</p><p>In the help file builder project that you use to test your presentation style, set the
project's <span class="code">Component Path</span> property to the folder containing your presentation style's
assembly.  If you have opened the project's <strong>Help File</strong> property page before setting the component path,
you may need to close and reopen the project in order for it to discover your presentation style assembly.</p></div></article></li><li><p>Optionally, select the <strong>Signing</strong> tab and check the "Sign the assembly" checkbox.
Select "&lt;New...&gt;" from the "Choose a strong name key file" dropdown, enter a filename, and click OK to
create the key file.  You can protect the key file with a password if you like or uncheck the option to create
one without a password.</p></li></ol></div></div><h2 id="Template" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>The Presentation Style Template Class</h2><div id="IDCABSection"><p>You are now ready to edit the presentation style class itself.  See the comments in the template
class for information on how to get started.  Some general information is given below.  Note that multiple
presentation styles can reside within the same assembly.  Add new class files to the project and implement the
necessary methods as described below and as shown in the template class.  You should separate each presentation
style out into its own subfolder and use the <span class="code">BasePath</span> property to tell the presentation
style where it can find its files.</p><p>The presentation style is derived from the
<span class="code">Sandcastle.Core.PresentationStyle.PresentationStyleSettings</span> class and consists of
several properties that you must set to define the content used by it.  These are described below.
Review the code for "<span class="code">TODO:</span>" comments to find sections that need attention such as
setting the presentation style's ID, defining the content, etc.  If you followed the steps in the
<strong>Creating the Project</strong> section, you can run the project and debug it by setting
breakpoints in the presentation style's code.  As noted above, set the test project's <span class="code">Component
Path</span> property to the folder containing the presentation style assembly first.  If necessary, close
and reopen the test project so that it can discover the presentation style.</p></div><h2 id="Metadata" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>The Export Attribute Metadata</h2><div id="IDDABSection"><p>The presentation style is a Managed Extensibility Framework (MEF) component.  The
<span class="code">Sandcastle.Core.PresentationStyle.PresentationStyleExportAttribute</span> is used to define the
necessary metadata that enables the help file builder to load and use the component.</p><h4 id="MetadataId" class="quickLinkHeader">Id</h4><div><p>The <span class="code">Id</span> parameter is required and is used to uniquely identify the
presentation style.</p></div><h4 id="MetadataTitle" class="quickLinkHeader">Title</h4><div><p>The <span class="code">Title</span> parameter is required and is used to provide a friendly name
that can be used in development tools rather than the ID.</p></div><h4 id="MetadataVersion" class="quickLinkHeader">Version</h4><div><p>The <span class="code">Version</span> property is optional and allows you to define the
presentation style version displayed in the help file builder property page when the presentation style is
selected.</p></div><h4 id="MetadataCopyright" class="quickLinkHeader">Copyright</h4><div><p>The <span class="code">Copyright</span> property is optional and allows you to define the
presentation style copyright displayed in the help file builder property page when the presentation style is
selected.</p></div><h4 id="MetadataDescription" class="quickLinkHeader">Description</h4><div><p>The <span class="code">Description</span> property is optional and allows you to define the
presentation style description displayed in the help file builder property page when the presentation style is
selected.</p></div><h4 id="MetadataIsDeprecated" class="quickLinkHeader">IsDeprecated</h4><div><p>The <span class="code">IsDeprecated</span> property is optional and allows you to specify
whether or not the presentation style has been deprecated.  If true, the property page will sort the deprecated
style to the end of the list of available presentation styles.  Deprecated presentation styles are include for
backward compatibility but may not receive any future updates or fixes.</p></div></div><h2 id="PresentationStyleClass" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>The Presentation Style Class</h2><div id="IDEABSection"><p>The derived class consists of one property and a constructor that you must implement.  The
properties in the base class are used to define the content and its locations.</p><h4 id="Location" class="quickLinkHeader">Location</h4><div><p>The <span class="code">Location</span> property is used to provide the location of the
presentation style component.  This is used as the root path to which all other base and content path values are
relative.  The default implementation in the template project returns the path of the executing assembly which is
typically sufficient.</p></div><h4 id="Constructor" class="quickLinkHeader">Constructor</h4><div><p>Use the constructor to initialize all of the other properties.  The template class contains
examples for all of the properties and mimics the settings for the existing VS2010 and VS2013 presentation
styles.</p></div><h4 id="BasePath" class="quickLinkHeader">BasePath</h4><div><p>This property defines the base path of the presentation style files relative to the assembly's
location.  If your assembly will reside in the same folder as the presentation style content, you can remove this
property setting.  If adding multiple presentation styles to the assembly, set this to the name of the subfolder
that contains the presentation style content folders.  All file and folder path values support environment
variables which will be expanded at runtime.  Other relative paths within a presentation style are considered to
be relative to the presentation style's base path.</p></div><h4 id="SupportedFormats" class="quickLinkHeader">SupportedFormats</h4><div><p>This defines the help file formats supported by the presentation style.  The
<span class="code">HelpFileFormats</span> values are:</p><ul><li><p><span class="code">HtmlHelp1</span> - HTML Help 1 (.chm)
								</p></li><li><p><span class="code">MSHelpViewer</span> - MS Help Viewer (.mshc)
								</p></li><li><p><span class="code">OpenXml</span> - Open XML document (.docx)
								</p></li><li><p><span class="code">Markdown</span> - Markdown output
								</p></li><li><p><span class="code">Website</span> - Website output
								</p></li></ul><p>If a presentation style does not support a particular help format, it can be omitted.</p></div><h4 id="NamespaceGrouping" class="quickLinkHeader">SupportsNamespaceGrouping</h4><div><p>Set this property to true if the presentation style supports namespace grouping.  When enabled,
it indicates that namespaces with a common root will be grouped in the table of contents.</p></div><h4 id="CodeSnippetGrouping" class="quickLinkHeader">SupportsCodeSnippetGrouping</h4><div><p>Set this property to true if the presentation style supports code snippet grouping.  When
enabled, it indicates that the Syntax Component can group and sort the code snippets based on the selected syntax
filters in the project.  It is expected that the presentation style will then render these groups as tabbed
sections or something similar in the topics in which they appear along with the supporting script to switch
between them to see the code snippets.</p></div><h4 id="ResourceItems" class="quickLinkHeader">ResourceItemsPath</h4><div><p>This defines the path to the shared content resource items.  These files contain the
localizable elements such as messages, section titles, language element names, etc.  The files in the indicated
folder will be passed as parameters to the content resolution components used by the <strong>BuildAssembler</strong>
tool.</p></div><h4 id="ToolResourceItems" class="quickLinkHeader">ToolResourceItemsPath</h4><div><p>This defines the path to the tool-specific shared content resource items.  These are used to
override the default resource items from the presentation style in order to do such things as insert project
properties into the values using tag substitution.  Files in the tool-specific resource items folder are expected
to be named using the language they represent plus a <em>.xml</em> extension
(<em>en-US.xml</em> for example).</p></div><h4 id="DocumentModelApplicator" class="quickLinkHeader">DocumentModelApplicator</h4><div><p>This defines the document model applicator to use on the reflection data to prepare it for use
with <strong>BuildAssembler</strong> in order to generate topics.  By default, the
<a href="d1ae481a-4c1e-f1b8-6dbf-c545c4a6e6ab.htm">StandardDocumentModel</a>
is used.  See the class documentation for its supported features and behavior when transforming the reflection
data.  If you want to change how the reflection data is updated, add or remove topic types, etc., you can
implement your own document model applicator and assign it to this property.</p></div><h4 id="ApiTableOfContentsGenerator" class="quickLinkHeader">ApiTableOfContentsGenerator</h4><div><p>This defines the handler used to generate the intermediate table of contents XML file used by
help formats that require a table of contents.  By default, the
<a href="9fac6dbd-2f55-1840-b34a-c090fc54ed22.htm">StandardApiTocGenerator</a>
is used.  See the class documentation for its supported features and behavior when generating the table of
contents.  If you want to change how the table of contents is generated, you can implement your own table of
contents generator and assign it to this property.</p></div><h4 id="BuildAssemblerConfiguration" class="quickLinkHeader">BuildAssemblerConfiguration</h4><div><p>This defines the <strong>BuildAssembler</strong> configuration file to use when
generating help file topics.</p></div><h4 id="ContentFiles" class="quickLinkHeader">ContentFiles</h4><div><p>This collection property is used to define the content from the presentation style that should
be embedded in the compiled help file such as images, style sheets, and scripts.  Add one or more
<span class="code">ContentFiles</span> instances that define the content files that should be copied and their
destination in the compiled help file.  The help file format parameter defines which format types the content
applies to.  Typically, this is the same as the <span class="code">SupportedFormats</span> property.  However, it
is possible to have format-specific content such as for websites only as shown in the template class.  The
source parameter defines the source location relative to the presentation style base path.  The optional
destination parameter, if specified, defines the relative location of the files in the compiled help file.
If omitted, the files are copied to a like-named folder relative to the root of the compiled help file.  If the
destination parameter is set to an empty string, the files are copied to the root of the compiled help file.
Unlike all other path values, the destination value must always be a relative path.</p><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Note</p></div><div class="message-body"><p>UNIX based web servers may be case-sensitive with regard to folder and filenames so match the
case of the folder and filenames in the elements to their actual casing on the file system.</p></div></article></div><h4 id="TransformComponentArguments" class="quickLinkHeader">TransformComponentArguments</h4><div><p>The transformations used by <strong>BuildAssembler</strong>'s
<span class="code">TransformComponent</span> typically have a set of parameters that can be used to alter aspects
of their processing such as inserting a logo image into the topic headers.  This property can be used by
third-party build tools such as the Sandcastle Help File Builder to modify them for the build.  It is up to
the build tool to insert the modified values into the appropriate configuration file at build time.</p><p>Add one or more <span class="code">TransformComponentArgument</span> instances to define the
parameters.  Each one has the following properties, most of which can be set in the constructor.</p><ul><li><p><span class="code">Key</span> - This property defines the argument key name.</p></li><li><p><span class="code">IsForConceptualBuild</span> - This property specifies whether or not to
include the parameter in the conceptual build.</p></li><li><p><span class="code">IsForReferenceBuild</span> - This property specifies whether or not to
include the parameter in the reference (API) build.</p></li><li><p><span class="code">Description</span> - This property provides a description of the
parameter that can be displayed by build tools.  It can be used to provide usage notes, information on the set of
valid values, and information about what happens if a value is not specified.</p></li><li><p><span class="code">Value</span> or <span class="code">Content</span>- These properties are
optional.  The <span class="code">Value</span> property allows you to specify a simple value to use for the
default.   If present, the <span class="code">Content</span> property value is ignored.  If a
<span class="code">Value</span> is not set, it is assumed that the <span class="code">Content</span> value will
serve as the value.  The <span class="code">Content</span> property allows for complex values such as XML to be
used (i.e. the syntax filter language definitions).  To restrict the argument to a simple value with no specific
default value, set the <span class="code">Value</span> property to an empty string or leave both properties set
to null.</p></li></ul></div><h4 id="PlugInDependencies" class="quickLinkHeader">PlugInDependencies</h4><div><p>This collection property is used to define one or more plug-in IDs on which the presentation
style depends.  It can be omitted if the presentation style has no plug-in dependencies.  If the identified
plug-ins are not present in the project when built, they will be added automatically to ensure that the build
succeeds.  If already present in the project (the user has added them to override their default configurations),
the project instances will be used instead.</p></div></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Other Resources</h4><div><a href="c8258d52-6664-4e96-86cd-6f75a854a69c.htm">Creating Custom Components</a></div></div></div><div class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Creating the Project</a></li><li><a class="quickLink">Create the Presentation Style Project</a></li><li><a class="quickLink">The Presentation Style Template Class</a></li><li><a class="quickLink">The Export Attribute Metadata</a><ul class="menu"><li><a class="quickLink">Id</a></li><li><a class="quickLink">Title</a></li><li><a class="quickLink">Version</a></li><li><a class="quickLink">Copyright</a></li><li><a class="quickLink">Description</a></li><li><a class="quickLink">IsDeprecated</a></li></ul></li><li><a class="quickLink">The Presentation Style Class</a><ul class="menu"><li><a class="quickLink">Location</a></li><li><a class="quickLink">Constructor</a></li><li><a class="quickLink">BasePath</a></li><li><a class="quickLink">SupportedFormats</a></li><li><a class="quickLink">SupportsNamespaceGrouping</a></li><li><a class="quickLink">SupportsCodeSnippetGrouping</a></li><li><a class="quickLink">ResourceItemsPath</a></li><li><a class="quickLink">ToolResourceItemsPath</a></li><li><a class="quickLink">DocumentModelApplicator</a></li><li><a class="quickLink">ApiTableOfContentsGenerator</a></li><li><a class="quickLink">BuildAssemblerConfiguration</a></li><li><a class="quickLink">ContentFiles</a></li><li><a class="quickLink">TransformComponentArguments</a></li><li><a class="quickLink">PlugInDependencies</a></li></ul></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"><p><a href="https://GitHub.com/EWSoftware/SHFB" target="_blank" rel="noopener noreferrer">[v2022.2.6.0] Copyright © 2006-2022, Eric Woodruff, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:Eric%40EWoodruff.us?Subject=Sandcastle%20Help%20File%20Builder%20Documentation">Eric Woodruff</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script> 
				</div><div class="column"><script type="text/javascript">
    function _dmBootstrap(file) {
        var _dma = document.createElement('script');
        _dma.type = 'text/javascript';
        _dma.async = true;
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
<div data-type="ad" data-publisher="ewsoftware.github.io" data-format="728x90" data-zone="SHFB"></div>
 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks()

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
});</script></body></html>