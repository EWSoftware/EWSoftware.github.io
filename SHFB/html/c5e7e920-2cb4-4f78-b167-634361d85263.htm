<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Open XML Document Help File Format</title><meta name="Help.Id" content="c5e7e920-2cb4-4f78-b167-634361d85263" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="c5e7e920-2cb4-4f78-b167-634361d85263" /><meta name="Description" content="The Open XML file format is used to produce word processing documents that can be opened by Microsoft Word and Open Office. Files in this format are convertible to other file formats such as PDF using other third-party tools and applications." /><meta name="tocFile" content="../toc/Root.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/EWSoftware/SHFB"><img alt="Sandcastle Help File Builder" style="height: 69px;" src="../icons/Sandcastle.jpg" /></a></div><div id="DocumentationTitle" class="level-item">Sandcastle Help File Builder Documentation</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a><a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a><a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a><a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><div id="HeaderPrelimContainer" class="level my-1 px-2"><div id="HeaderTextContainer" class="level-left"><div class="level-item"><span class="has-text-grey-light">SHFB Default 2022 Presentation Style - Coming Soon</span></div></div></div><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Open XML Document Help File Format</h1><div><p>The Open XML file format is used to produce word processing documents that can be opened by Microsoft
Word and Open Office.  Files in this format are convertible to other file formats such as PDF using other
third-party tools and applications.</p><ul class="is-hidden-tablet"><li><a href="#KnownIssues">Knowns Issues and Limitations</a></li><li><a href="#Troubleshooting">Troubleshooting Corrupted Output</a></li></ul></div><h2 id="KnownIssues" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Knowns Issues and Limitations</h2><div id="IDBABSection"><ul><li><p>The Open XML format works best for projects with roughly 1,000 topics or less.  Bear in mind
that topic count is no indication of actual page count as many topics can span several pages.  For example, the
format works quite well for the XML Comments Guide (180 topics resulting in 277 pages) and the MAML Guide (90
topics resulting in 136 pages).  A test case project with 508 topics generated 722 pages and was still quite
manageable.  However, the Sandcastle Help File Builder help project generated over 2,800 topics which generated
over 6,100 pages.  While the file could be loaded, it took a while and was rather unwieldy.  Saving to other
formats was not possible as Word ran out of memory before it could finish saving the converted file.  If you have
a large project with 1,000 or more topics, this is probably not a good option and you should consider one of the
other file formats instead.</p></li><li><p>Unlike HTML, the Open XML format is completely unforgiving with regard to ill-formed or illegal
content.  The build process tries to fix up a number of common issues but it may miss some cases resulting in a
document that states it is corrupted or has issues when opened.  You will need to track down the invalid markup
and fix it (i.e. wrap text in paragraphs, remove unsupported HTML markup, etc.).  See the following section for
tips on troubleshooting corrupted or invalid documents.</p></li><li><article class="message is-warning"><div class="message-header"><p><span class="icon"><i class="fa fa-warning"></i></span>  Important</p></div><div class="message-body"><p>The physical page layout and page numbering relies on several factors all of which are
controlled entirely by the application that consumes the resulting document <strong>not</strong> the one
that produces it.  As such, the help file builder <strong>cannot</strong> determine page layout nor page
numbers at build time.</p></div></article><p>Some of the side-effects of this limitation are as follows:</p><ul><li><p>There may be blank pages between topics.  These will need to be manually removed after
generating the document.</p></li><li><p>Syntax sections and code examples may wrap lines due to the page margins.  If necessary,
you may need to reformat the code examples to fix up any unwanted line wraps.</p></li><li><p>Since there is no way to determine valid page numbers, a table of contents is not added to
the document.  For similar reasons and also because tagging index words is rather problematic while generating
Open XML, an index is not added to the document either.  These can be added and generated after the document has
been produced using the word processing application of your choice.</p></li></ul></li><li><p>There are many different bibliography formats available in applications such as Microsoft Word.
As such, the bibliography elements are not supported.  If desired, add a bibliography in the desired format to
the document after it is produced with the word processing application of your choice.</p></li><li><p>Code colorization is supported.  However, line numbering and collapsible regions are not
supported and those options are ignored.</p></li><li><p>Obviously, the language filter from the HTML help formats is not supported.  As such,
language-specific text is shown using the generic, multi-language style.  Likewise, syntax sections and code
blocks are shown in a sequential fashion similar to the topic previewer.</p></li><li><p>The MAML <span class="code">markup</span> element is supported for passing through Open XML
markup directly into the document.  HTML markup is <strong>not</strong> supported in Open XML documents.
Any HTML in MAML <span class="code">markup</span> elements will likely corrupt the document.</p><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Tip</p></div><div class="message-body"><p>A few HTML elements are recognized and used in the transformations as a requirement of
the presentation style to handle certain cases that cannot be taken care of in the transformations and to
support certain build component output and localized resource items.  The Open XML file builder task translates
these elements into Open XML elements when the topics are merged into a single document body.</p><p>Those elements are: <span class="code">a</span> (anchor), <span class="code">br</span> (line
break), <span class="code">img</span> (image), <span class="code">span</span> (used for a limited set of named
styles), <span class="code">ul</span>/<span class="code">li</span> (used to define lists).  If these elements
appear in a <span class="code">markup</span> element, they will be passed through and processed as if the XSL
transformations or a build component had added them.  Note that they will only be processed based on the
conditions expected by the Open XML file builder task.  Additional attributes on the elements other than those
expected will be ignored.  As always, it is best to avoid use of the <span class="code">markup</span> element
whenever possible.</p></div></article></li><li><p>Unlike MAML, HTML elements are prevalent in XML comments and the presentation style will make
its best effort to translate as many HTML elements in the XML comments as possible to their Open XML equivalents.
However, the end result may need fixing up in the generated document.  Better results are obtained with well
formed HTML content.  Note that styling attributes are ignored as it is not possible to translate those to an
Open XML equivalent.  As with MAML, staying with the standard XML comments elements whenever possible will
produce the best results.</p></li><li><p>It is common in XML comments to omit the containing paragraph element in simple summary and
remarks content.  Normally this is not an issue and the content will be converted to a paragraph with the
expected formatting.  In some cases, such as when nested elements appear within the content, it may not wrap as
expected and unintended line breaks may appear in the generated document.  In most cases, the solution to this
problem is to wrap the content in a paragraph element in the XML comments so that the help file builder does not
have to guess the intended layout.</p></li><li><p>Unlike HTML, self-closing and empty paragraphs will be rendered in the document and will
consume space in both MAML topics and XML comments.  They cannot be removed as more often than not it ends up
combining text into a single paragraph that is not intended to be combined.  The fix is to wrap the text in the
paragraph elements and not use self-closing paragraphs which gets the expected results regardless of file format.</p></li><li><p>Headers and footers are separate document parts in Open XML content and localized resource
items cannot be used within them.  A basic header containing the help title and a basic footer with a page number
are included by default.  The following project properties are ignored:</p><ul><li><p>Additional header content</p></li><li><p>Additional footer content</p></li><li><p>Copyright notice URL</p></li><li><p>Copyright notice text</p></li><li><p>Feedback e-mail address</p></li><li><p>Feedback e-mail link text</p></li></ul><p>If you want this information to appear in the header and footer, it must be added to the
generated document manually.  Since adding all of the information may unnecessarily clutter the header and footer
it may be better to add it in a single topic somewhere near the start of the document.</p><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Tip</p></div><div class="message-body"><p>As in other help file formats, stock content file overrides are supported.  Including a
<em>word/header.xml</em> and/or <em>word/footer.xml</em> file containing appropriate,
valid content in your project with the Build Action set to <span class="code">Content</span> will override the
default header and/or footer in the generated document.  Similarly, including a <em>word/styles.xml</em>
file containing valid content with the Build Action set to <span class="code">Content</span> will override the
default style sheet used in the document.</p></div></article></li><li><p>The <span class="code">SDK Link Target</span> project property is ignored.  Links to external
content are always opened in a new browser window or the related application that handles the given link type.</p></li></ul></div><h2 id="Troubleshooting" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Troubleshooting Corrupted Output</h2><div id="IDCABSection"><p>As mentioned earlier, the Open XML file format is extremely strict and requires that all content
conform to the Open XML schema.  Deviation from the expected format usually results in the consuming application
reporting that the file is corrupted in some way.  This section covers how to diagnose the issue.</p><p>The consuming application, such as Microsoft Word, will typically display a dialog box stating that
the content is corrupt.  In Microsoft Word, clicking the <strong>Details</strong> button will provide more information
about the problem and gives a line number within the XML content.  By default, the content is rendered without
whitespace between elements so the line number is not of much use.  To obtain a useful line number and locate the
invalid content, do the following:</p><ol><li><p>In your help file project, select the <strong>Build</strong> property category.
					</p></li><li><p>Disable the <strong>Clean intermediate files after a successful build</strong> option.
					</p></li><li><p>Enable the <strong>Indent rendered HTML</strong> option.  In this case, it's rendered XML but the
result we need is the same.</p></li><li><p>Rebuild your project and open the resulting document.  Use the error dialog within the
application to display the line number at which the failure is occurring as described above.</p></li><li><p>Navigate to the working folder for your project that contains the Open XML content generated
by the build.  This is typically the <em>.\Help\Working\Output\OpenXml\word</em> folder beneath the
project folder unless you defined a different location using the <strong>Working files path</strong> project property.</p></li><li><p>In that folder, locate and open the <em>document.xml</em> file in the text editor
of your choice and go to the line number reported as the point of failure.  You should find the invalid content
such as HTML elements within a few lines of that location.  By scrolling up, you can usually use the topic title
to identify the MAML topic or API member that contains the invalid content.</p></li><li><p>Once the topic or API member has been determined, you can open the topic or go to the source
code and fix the offending content.</p></li><li><p>Once the problem has been fixed and a valid document is being produced, be sure to turn off
the <strong>Indent rendered HTML</strong> option as it is only for debugging purposes, it can affect the layout of the
rendered content, and produces much larger content than is necessary.</p></li></ol><p>Another common issue is missing images.  While this may not necessarily result in a corrupted
document, it does result in invalid content since there is only a placeholder where the image should appear.
Check the build log as it will contain warning messages about image files that were referenced in the content
but could not be found.  The causes of missing images are usually an invalid path or the image not being marked
as content so that it is included in the build output.</p><article class="message is-info"><div class="message-header"><p><span class="icon"><i class="fa fa-info-circle"></i></span>  Tip</p></div><div class="message-body"><p>If your project is quite large, using the API filter to limit the number of members included in
the output and disabling topics in the content layout file can reduce the size of the resulting document XML and
may help narrow down the location of the failure.</p></div></article></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Other Resources</h4><div><a href="da405a33-3eeb-4451-9aa8-a55be5026434.htm">Build Category Properties</a></div><div><a href="1b2dff59-92cc-4578-b261-f3849f30c26c.htm">Help File Category Properties</a></div></div></div><div class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Knowns Issues and Limitations</a></li><li><a class="quickLink">Troubleshooting Corrupted Output</a></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"><p><a href="https://GitHub.com/EWSoftware/SHFB" target="_blank" rel="noopener noreferrer">[v2022.2.6.0] Copyright © 2006-2022, Eric Woodruff, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:Eric%40EWoodruff.us?Subject=Sandcastle%20Help%20File%20Builder%20Documentation">Eric Woodruff</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script> 
				</div><div class="column"><script type="text/javascript">
    function _dmBootstrap(file) {
        var _dma = document.createElement('script');
        _dma.type = 'text/javascript';
        _dma.async = true;
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
<div data-type="ad" data-publisher="ewsoftware.github.io" data-format="728x90" data-zone="SHFB"></div>
 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks()

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
});</script></body></html>