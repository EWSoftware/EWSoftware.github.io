<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Deploying an MS Help Viewer File</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="deployment, MS Help Viewer" /><meta name="System.Keywords" content="MS Help Viewer" /><meta name="System.Keywords" content="MSHA" /><meta name="System.Keywords" content="MSHC" /><meta name="Microsoft.Help.Id" content="4baf93f2-f395-4281-b7ef-bfe6c878a4d7" /><meta name="Description" content="The MS Help Viewer system maintains a catalog of all help packages currently installed on a machine. This catalog determines what books are included in each package as well as maintaining references between the packages." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Sandcastle Help File Builder Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\bd1ddb51-1c4f-434f-bb1a-ce2135d3a909.htm" title="Sandcastle Help File Builder Documentation" tocid="roottoc">Sandcastle Help File Builder Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e32086c6-de17-4e54-a746-1ac80bf0c45a.htm" title="Project Properties Window" tocid="e32086c6-de17-4e54-a746-1ac80bf0c45a">Project Properties Window</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/5f743a6e-3239-409a-a8c1-0bff4b5375f4.htm" title="MS Help Viewer Category Properties" tocid="5f743a6e-3239-409a-a8c1-0bff4b5375f4">MS Help Viewer Category Properties</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/4baf93f2-f395-4281-b7ef-bfe6c878a4d7.htm" title="Deploying an MS Help Viewer File" tocid="4baf93f2-f395-4281-b7ef-bfe6c878a4d7">Deploying an MS Help Viewer File</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/534c4ff1-3bba-4431-a3a6-76dcb2d374f8.htm" title="Help Library Manager Launcher Utility" tocid="534c4ff1-3bba-4431-a3a6-76dcb2d374f8">Help Library Manager Launcher Utility</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/650e50e7-f174-472a-bbea-f9000dba722c.htm" title="Signing MS Help Viewer Content" tocid="650e50e7-f174-472a-bbea-f9000dba722c">Signing MS Help Viewer Content</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="Sandcastle Help File Builder" width="70" height="68" src="../icons/Sandcastle.jpg" /></td><td class="titleColumn"><h1>Deploying an MS Help Viewer File</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>The MS Help Viewer system maintains a catalog of all help packages currently installed on a machine.
This catalog determines what books are included in each package as well as maintaining references between the
packages.  More information can be found on the <a href="http://kb.helpwaregroup.com/ms-help-viewer/hvinfo" title="MS Help Viewer" target="_blank">Introducing MS Help Viewer 1.0</a>  page at the HelpWare Group website.</p></div><div id="ID1RBSection" class="collapsibleSection"><p>Unlike HTML Help 1 (CHM) files, an MS Help Viewer package or book must be installed in order to view
it. This makes deploying MS Help Viewer documentation more complex than simply delivering a single file and
creating a shortcut to it.  However, it is much simpler than its predecessor, MS Help 2.</p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Tip" /> Tip</th></tr><tr><td><p>Due to the requirement that MS Help Viewer files be installed before you can view them which can be time
consuming, it is recommended that you generate one of the other help formats such as Help 1 or website while
developing and proofreading your help file.</p></td></tr></table></div><p>When producing an MS Help Viewer file, the help file builder produces a valid help content setup file
suitable for use by the Help Library Manager.  It also includes a Help Library Manager launcher utility that
takes care of the standard housekeeping tasks required when installing and removing MS Help Viewer content.  It
is a command line tool that can be included by scripted installers as well as Windows Installer packages as a
custom action.  In order to deploy the generated MS Help Viewer file, follow these steps:</p><ol><li><p>Set the MS Help Viewer <a href="5f743a6e-3239-409a-a8c1-0bff4b5375f4.htm">project properties</a>
as needed.  At the minimum, you should set the <span class="code">Vendor Name</span> and <span class="code">Product Title</span>
properties to something other than their default values.</p></li><li><p>Build the help project.</p></li><li><p>In order to install an MS Help Viewer file, a help content setup file is required.  The help file
builder automatically creates a help content setup file for you named after the help file but with a
<em>.msha</em> extension.  This allows you to build and deploy multiple MS Help Viewer files to the
same location.</p><div class="alert"><table><tr><th><img src="../icons/AlertCaution.png" alt="Important note" /> Important</th></tr><tr><td><p>For MS Help Viewer 1.0, the name of the help content setup file used during installation must be
<em>HelpContentSetup.msha</em>.  If you only have one help file, you can rename the setup file
created by the help file builder to <em>HelpContentSetup.msha</em>.  If you have multiple help
files, you can rename one of the setup files and merge the package information from the others into it.</p></td></tr></table></div></li><li><p>Include all of the generated help files (the <em>.mshc</em> files) as well as the
<em>HelpContentSetup.msha</em> and the <em>HelpLibraryManagerLauncher.exe</em> executable
in your installer.</p></li><li><p>During installation, copy the help files, the help content setup file, and
<em>HelpLibraryManagerLauncher.exe</em> to their installed location.</p></li><li><p>Execute the <a href="534c4ff1-3bba-4431-a3a6-76dcb2d374f8.htm">Help Library Manager launcher</a>
or a script to install the help file.  This step will vary based on whether or not you are using signed cabinet
files to deploy your help content.  Note that silent installs are only allowed with signed cabinet files.  For
unsigned files, the Help Library Manager will always appear and confirm the installation.  Below is an example of
the script that the help file builder creates to install the help file (lines wrapped for display purposes).</p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAABDABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAABDABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAABDABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">@<span class="highlight-keyword">ECHO OFF</span><span class="highlight-comment"> </span>
<span class="highlight-keyword">CLS</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> This is an example script to show how to use the Help Library Manager Launcher</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> to install an MS Help Viewer file.  You can use this as an example for creating</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> a script to run from your product's installer.</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> NOTE: If not executed from within the same folder as the executable, a full path</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> is required on the executable and the HelpContentSetup.msha file.</span>

<span class="highlight-keyword">IF</span> <span class="highlight-literal">"%1%"</span>==<span class="highlight-literal">""</span> <span class="highlight-keyword">GOTO</span> MissingVersion
<span class="highlight-keyword">IF</span> <span class="highlight-literal">"%1%"</span>==<span class="highlight-literal">"1.0"</span> <span class="highlight-keyword">GOTO</span> HelpViewer1

<span class="highlight-keyword">GOTO</span> HelpViewer2:

:HelpViewer1

<span class="highlight-keyword">REM</span><span class="highlight-comment"> Help Viewer 1.0</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> Uninstall first in case it is already there.  If not, it won't install below.</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> We'll ignore any error output by redirecting it to NUL.</span>
HelpLibraryManagerLauncher.exe /product <span class="highlight-literal">"VS"</span> /version <span class="highlight-literal">"100"</span> /locale en-us
    /uninstall /silent /vendor <span class="highlight-literal">"EWSoftware"</span>
    /productName <span class="highlight-literal">"Sandcastle Help File Builder Example Project"</span>
    /mediaBookList <span class="highlight-literal">"Sandcastle Test Case Library"</span> &gt; <span class="highlight-keyword">NUL</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> For Help Viewer 1.0. the setup name must be HelpContentSetup.msha so make sure</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> we copy the setup file to that name.  SHFB names it after the help file so that</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> multiple files can be deployed to the same output older at build time.</span>
<span class="highlight-keyword">IF</span> <span class="highlight-keyword">EXIST</span> <span class="highlight-literal">"TestCaseProject.msha"</span> <span class="highlight-keyword">COPY</span> /Y <span class="highlight-literal">"TestCaseProject.msha"</span> HelpContent<span class="highlight-keyword">Set</span><span class="highlight-xml-attribute-equal">up.msha</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> Install the new content.</span>
HelpLibraryManagerLauncher.exe /product <span class="highlight-literal">"VS"</span> /version <span class="highlight-literal">"100"</span> /locale en-us
    /sourceMedia <span class="highlight-literal">"%CD%\HelpContentSetup.msha"</span>

<span class="highlight-keyword">GOTO</span> <span class="highlight-keyword">Exit</span>

:HelpViewer2

<span class="highlight-keyword">REM</span><span class="highlight-comment"> Help Viewer 2.x</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> Uninstall first in case it is already there.  If not, it won't install below.</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> We'll ignore any error output by redirecting it to NUL.</span>
HelpLibraryManagerLauncher.exe /viewerVersion %<span class="highlight-number">1</span> /locale en-us /wait <span class="highlight-number">0</span>
    /operation uninstall /vendor <span class="highlight-literal">"EWSoftware"</span>
    /productName <span class="highlight-literal">"Sandcastle Help File Builder Example Project"</span>
    /bookList <span class="highlight-literal">"Sandcastle Test Case Library"</span> &gt; <span class="highlight-keyword">NUL</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> Install the new content.</span>
HelpLibraryManagerLauncher.exe /viewerVersion %<span class="highlight-number">1</span> /locale en-us /wait <span class="highlight-number">0</span>
    /operation install /sourceUri <span class="highlight-literal">"%CD%\TestCaseProject.msha"</span>

<span class="highlight-keyword">GOTO</span> <span class="highlight-keyword">Exit</span>

:MissingVersion
<span class="highlight-keyword">ECHO</span><span class="highlight-comment"> A help viewer version parameter is required</span>

:<span class="highlight-keyword">Exit</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAABDABAAA");</script></li><li><p>During uninstallation, before the help files are removed, execute the Help Library Manager launcher
to uninstall your help file.  Below is an example of the script that the help file builder creates to remove the
help file  (lines wrapped for display purposes).</p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAADABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAADABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAADABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">@<span class="highlight-keyword">ECHO OFF</span><span class="highlight-comment"> </span>
<span class="highlight-keyword">CLS</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> This is an example script to show how to use the Help Library Manager Launcher</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> to remove an MS Help Viewer file.  You can use this as an example for creating</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> a script to run from your product's uninstaller.</span>

<span class="highlight-keyword">REM</span><span class="highlight-comment"> NOTE: If not executed from within the same folder as the executable, a full path</span>
<span class="highlight-keyword">REM</span><span class="highlight-comment"> is required on the executable.</span>

<span class="highlight-keyword">IF</span> <span class="highlight-literal">"%1%"</span>==<span class="highlight-literal">""</span> <span class="highlight-keyword">GOTO</span> MissingVersion
<span class="highlight-keyword">IF</span> <span class="highlight-literal">"%1%"</span>==<span class="highlight-literal">"1.0"</span> <span class="highlight-keyword">GOTO</span> HelpViewer1

<span class="highlight-keyword">GOTO</span> HelpViewer2

:HelpViewer1

<span class="highlight-keyword">REM</span><span class="highlight-comment"> Help Viewer 1.0</span>
HelpLibraryManagerLauncher.exe /product <span class="highlight-literal">"VS"</span> /version <span class="highlight-literal">"100"</span> /locale en-us
    /uninstall /silent /vendor <span class="highlight-literal">"EWSoftware"</span>
    /productName <span class="highlight-literal">"Sandcastle Help File Builder Example Project"</span>
    /mediaBookList <span class="highlight-literal">"Sandcastle Test Case Library"</span>

<span class="highlight-keyword">GOTO</span> <span class="highlight-keyword">Exit</span>

:HelpViewer2

<span class="highlight-keyword">REM</span><span class="highlight-comment"> Help Viewer 2.x</span>
HelpLibraryManagerLauncher.exe /viewerVersion %<span class="highlight-number">1</span> /locale en-us /wait <span class="highlight-number">0</span>
    /operation uninstall /vendor <span class="highlight-literal">"EWSoftware"</span>
    /productName <span class="highlight-literal">"Sandcastle Help File Builder Example Project"</span>
    /bookList <span class="highlight-literal">"Sandcastle Test Case Library"</span>

<span class="highlight-keyword">GOTO</span> <span class="highlight-keyword">Exit</span>

:MissingVersion
<span class="highlight-keyword">ECHO</span><span class="highlight-comment"> A help viewer version parameter is required</span>

:<span class="highlight-keyword">Exit</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAADABAAA");</script></li></ol><p>Your product's installer can create a shortcut to open your Help Viewer file by executing the
following command (lines wrapped for display purposes):</p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EABABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">"ms-xhelp:///?method=page&amp;id=57301AAE-7D51-4006-A9EF-C82B6C0FF21E&amp;product=vs&amp;
productversion=100&amp;locale=en-us"</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABABAAA");</script><p>Substitute the ID of a page in your product's help file and adjust the product, version, and locale
as needed in the example above.  See the <a href="http://mshcmigrate.helpmvp.com/default/starthere" title="Install and view MSHV files" target="_blank">Getting Started with HV 1.0</a> page at the HelpWare Group website for more information on
installing help files and viewing help content.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="534c4ff1-3bba-4431-a3a6-76dcb2d374f8.htm">Help Library Manager Launcher Utility</a></div><div class="seeAlsoStyle"><a href="5f743a6e-3239-409a-a8c1-0bff4b5375f4.htm">MS Help Viewer Category Properties</a></div><div class="seeAlsoStyle"><a href="650e50e7-f174-472a-bbea-f9000dba722c.htm">Signing MS Help Viewer Content</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://GitHub.com/EWSoftware/SHFB" target="_blank">[v2018.5.29.0] Copyright © 2006-2018, Eric Woodruff, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:Eric%40EWoodruff.us?Subject=Sandcastle Help File Builder Documentation">Eric Woodruff</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div><script type="text/javascript">
    function _dmBootstrap(file) {
        var _dma = document.createElement('script');
        _dma.type = 'text/javascript';
        _dma.async = true;
        _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
<div data-type="ad" data-publisher="ewsoftware.github.io" data-format="728x90" data-zone="SHFB"></div>
</body></html>